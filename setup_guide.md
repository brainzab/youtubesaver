# Руководство по установке и настройке YouTube Downloader Bot

## Содержание
1. [Подготовка](#подготовка)
2. [Создание бота в Telegram](#создание-бота-в-telegram)
3. [Регистрация аккаунта MEGA](#регистрация-аккаунта-mega)
4. [Настройка MongoDB (опционально)](#настройка-mongodb-опционально)
5. [Локальная установка](#локальная-установка)
6. [Деплой на Railway](#деплой-на-railway)
7. [Устранение неполадок](#устранение-неполадок)

## Подготовка

Перед началом работы необходимо убедиться, что у вас есть:
- Аккаунт Telegram
- Аккаунт на MEGA (или готовность его создать)
- Аккаунт GitHub (для деплоя на Railway)
- Аккаунт Railway (если планируете размещать бота на этой платформе)
- Python 3.8+ (для локального запуска)

## Создание бота в Telegram

1. Откройте Telegram и найдите бота [@BotFather](https://t.me/BotFather)
2. Отправьте команду `/newbot`
3. Следуйте инструкциям BotFather:
   - Введите имя для бота (например, "YouTube Downloader Bot")
   - Введите уникальное имя пользователя для бота (должно заканчиваться на "bot")
4. После создания бота BotFather отправит вам сообщение с токеном бота. Сохраните этот токен, он потребуется для настройки.
5. Для получения своего ID в Telegram, найдите бота [@userinfobot](https://t.me/userinfobot) и отправьте ему любое сообщение. Он ответит вам информацией о вашем аккаунте, включая ID.

## Регистрация аккаунта MEGA

1. Перейдите на сайт [MEGA](https://mega.nz/register) и зарегистрируйте новый аккаунт
2. Рекомендуется создать отдельный аккаунт для бота
3. После регистрации запомните email и пароль - они потребуются для настройки

## Настройка MongoDB (опционально)

Для сбора статистики и хранения данных рекомендуется настроить базу данных MongoDB.

1. Зарегистрируйтесь на [MongoDB Atlas](https://www.mongodb.com/cloud/atlas/register)
2. После регистрации создайте новый кластер (можно использовать бесплатный тариф)
3. В разделе "Database Access" создайте нового пользователя с правами на чтение и запись
4. В разделе "Network Access" добавьте свой IP-адрес или разрешите доступ со всех IP-адресов (0.0.0.0/0)
5. В разделе "Clusters" нажмите "Connect" -> "Connect your application"
6. Скопируйте строку подключения (URI) и замените `<username>`, `<password>` и `<dbname>` на ваши данные
   Пример: `mongodb+srv://username:password@cluster.mongodb.net/youtube_downloader`

## Локальная установка

1. Клонируйте репозиторий:
```bash
git clone https://github.com/username/youtube-downloader-bot.git
cd youtube-downloader-bot
```

2. Создайте виртуальное окружение Python:
```bash
python -m venv venv
```

3. Активируйте виртуальное окружение:
   - Windows: `venv\Scripts\activate`
   - Linux/macOS: `source venv/bin/activate`

4. Установите зависимости:
```bash
pip install -r requirements.txt
```

5. Создайте файл `.env` в корневой директории проекта и добавьте следующие строки:
```
TELEGRAM_BOT_TOKEN=your_telegram_bot_token
MEGA_EMAIL=your_mega_email
MEGA_PASSWORD=your_mega_password
MONGODB_URI=mongodb+srv://username:password@cluster.mongodb.net/youtube_downloader
ADMIN_USER_ID=your_telegram_user_id
```

6. Запустите бота:
```bash
python bot.py
```

7. Теперь бот должен быть онлайн и готов к использованию. Проверьте его работу, отправив команду `/start` боту в Telegram.

## Деплой на Railway

### Шаг 1: Подготовка репозитория GitHub

1. Создайте новый репозиторий на GitHub
2. Загрузите все файлы проекта в репозиторий:
```bash
git init
git add .
git commit -m "Initial commit"
git branch -M main
git remote add origin https://github.com/username/your-repo-name.git
git push -u origin main
```

### Шаг 2: Настройка проекта на Railway

1. Зарегистрируйтесь на [Railway](https://railway.app/)
2. После входа в аккаунт нажмите кнопку "New Project"
3. Выберите "Deploy from GitHub repo"
4. Предоставьте Railway доступ к вашему GitHub аккаунту и выберите репозиторий с ботом
5. Railway автоматически определит, что это Python-проект и настроит базовое окружение

### Шаг 3: Настройка переменных окружения на Railway

1. В панели управления проектом перейдите во вкладку "Variables"
2. Добавьте те же переменные окружения, что и в локальном файле `.env`:
   - `TELEGRAM_BOT_TOKEN` - токен вашего бота
   - `MEGA_EMAIL` - email аккаунта MEGA
   - `MEGA_PASSWORD` - пароль аккаунта MEGA
   - `MONGODB_URI` - URI для подключения к MongoDB
   - `ADMIN_USER_ID` - ваш Telegram ID

### Шаг 4: Завершение деплоя

1. После добавления переменных окружения Railway автоматически перезапустит ваш сервис
2. Перейдите во вкладку "Deployments", чтобы убедиться, что ваш бот успешно запущен
3. Если вы видите "Deployment successful", значит бот работает
4. Проверьте работу бота, отправив ему команду `/start` в Telegram

## Устранение неполадок

### Бот не отвечает
1. Проверьте, правильно ли указан токен бота в переменных окружения
2. Убедитесь, что приложение успешно запущено (локально или на Railway)
3. Проверьте логи на наличие ошибок

### Проблемы с загрузкой видео
1. Убедитесь, что ссылка на видео действительна и видео не удалено с YouTube
2. Проверьте права доступа к директориям `downloads` и `temp`
3. Убедитесь, что у вас достаточно свободного места на сервере

### Проблемы с MEGA
1. Проверьте правильность учетных данных MEGA
2. Убедитесь, что на аккаунте MEGA достаточно свободного места
3. Если используете бесплатный аккаунт MEGA, помните о лимитах на трафик

### Проблемы с MongoDB
1. Проверьте правильность строки подключения URI
2. Убедитесь, что IP-адрес сервера добавлен в белый список MongoDB
3. Проверьте, что пользователь имеет необходимые права доступа

Если у вас остались вопросы или проблемы при настройке бота, создайте issue в репозитории проекта на GitHub. 